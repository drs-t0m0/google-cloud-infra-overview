# Cloud VPN 解説

## Google Cloud VPNとは

Google Cloud VPNは、IPsec VPN接続を使用して、オンプレミスのネットワークや他のクラウド環境とGoogle CloudのVirtual Private Cloud（VPC）ネットワークとの間に、安全な接続を確立するサービスです。インターネットを経由するトラフィックは、VPNゲートウェイによって暗号化および復号化され、データの機密性を保ちます。

Cloud VPNには、高可用性（HA）VPNとClassic VPNの2種類があります。通常はHA VPNが推奨されます。

## 主な機能

* **セキュアな接続:** IPsecトンネルにより、インターネット経由の通信を暗号化し、安全性を確保します。
* **ハイブリッド接続:** オンプレミス環境とGoogle Cloudの間で、安全かつ柔軟な接続を確立できます。
* **サイト間接続:** 異なるVPCネットワーク間を安全に接続することも可能です。
* **高可用性（HA VPN）:** 99.99%のSLA（サービスレベル契約）を提供し、可用性を高めます。冗長化された構成により、計画外のダウンタイムを最小限に抑えます。
* **動的ルーティング（HA VPN推奨）:** Cloud Routerと連携することで、ネットワーク構成の変更に柔軟に対応できます。
* **静的ルーティング（Classic VPN）:** ポリシーベースまたはルートベースの静的ルーティングをサポートします。
* **柔軟なルーティング:** VPCネットワーク間でルートを柔軟にアドバタイズできます。
* **高いスケーラビリティ:** 最大2,000本のVPNトンネルをサポートし、大規模なネットワーク環境にも対応可能です（HA VPN）。
* **IKEv1およびIKEv2のサポート:** 異なるVPN要件に対応するために、両方のIKEバージョンをサポートしています。

## 料金

Cloud VPNの料金は、主に以下の要素に基づいて計算されます。

* **VPNゲートウェイの料金:** ゲートウェイの種類と稼働時間に基づいて課金されます。HA VPNゲートウェイの方がClassic VPNゲートウェイよりも一般的に高価です。
* **トンネルの料金:** トンネルの数と稼働時間に基づいて課金されます。
* **送信データ転送料金:** Google Cloudから外部ネットワークへ送信されるデータ量に応じて課金されます。受信データ転送は無料です。
* **予約済み外部IPアドレス料金:** VPNゲートウェイに割り当てられた予約済みの外部IPアドレスに対して課金されますが、トンネルで使用されている場合は無料です。
* **リージョンによる料金:** 料金はリージョンによって異なる場合があります。

具体的な料金については、[Google Cloud VPNの料金ページ](https://cloud.google.com/network-connectivity/docs/vpn/pricing?hl=ja)をご確認ください。料金計算ツールも提供されています。

## 類似サービスとの比較

Cloud VPNは、従来のハードウェアVPNと比較して、以下のような利点があります。

* **スケーラビリティ:** 需要に応じてVPNの容量を容易に調整できます。従来のVPNでは、ハードウェアの追加やアップグレードが必要になる場合があります。
* **コスト効率:** 従量課金制であり、使用した分のみ料金が発生します。従来のVPNでは、ハードウェアの購入、保守、アップグレードなどのコストがかかります。
* **高可用性:** HA VPNは、冗長化された構成により高い可用性を実現します。従来のVPNでも冗長構成を組むことは可能ですが、複雑でコストがかかる場合があります。
* **クラウドネイティブ:** Google Cloudの他のサービスとの連携が容易です。
* **セキュリティ:** 常に最新のセキュリティ機能と脆弱性パッチが適用されます。

他のクラウドプロバイダーも同様のVPNサービスを提供しています。例えば、AWSのAWS VPN、AzureのAzure VPN Gatewayなどがあります。これらのサービスも、セキュアなハイブリッド接続やサイト間接続を提供しており、料金体系や機能は類似していますが、各プラットフォームの特性に合わせて最適化されています。

## 利用シナリオ

Cloud VPNは、以下のような様々なシナリオで利用できます。

* **オンプレミス環境とGoogle Cloudの安全な接続:** オンプレミスのデータセンターにあるアプリケーションやリソースを、Google Cloud上のVPCネットワーク内の仮想マシンやサービスと安全に通信させたい場合。
* **異なるVPCネットワーク間の安全な接続:** 複数のVPCネットワークを相互に接続し、セキュアな環境でリソースを共有したい場合。
* **ディザスタリカバリ:** オンプレミス環境に障害が発生した場合に備えて、Google Cloud上にDR（ディザスタリカバリ）環境を構築し、Cloud VPNで接続しておくことで、迅速なフェイルオーバーを実現できます。
* **開発・テスト環境の分離:** 本番環境とは別に、開発環境やテスト環境をVPCネットワーク内に構築し、Cloud VPNでセキュアにアクセスしたい場合。
* **サードパーティとの安全な接続:** ビジネスパートナーや顧客のネットワークと、自社のGoogle Cloud環境を安全に接続し、データやアプリケーションを共有したい場合。
* **クラウド移行:** オンプレミス環境からGoogle Cloudへの段階的な移行を行う際に、Cloud VPNを使用して両方の環境を安全に接続し、スムーズな移行を実現できます。

Cloud VPNは、セキュアで柔軟なネットワーク接続を実現するための重要なサービスです。お客様のニーズに合わせて、HA VPNまたはClassic VPNを選択し、適切な構成を行うことで、Google Cloudの利点を最大限に活用できます。

## 参考

- https://cloud.google.com/network-connectivity/docs/vpn/concepts/overview?hl=ja
- https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_vpn_gateway

